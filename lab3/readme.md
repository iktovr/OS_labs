# Потоки

## Обмен данными с потоками

Взаимодействие с потоками происходит через общую память. Это можно сделать несколькими способами:
1. Через глобальные переменные (example1.cpp).
2. Создать локальную статическую/динамическую переменную и передать адрес в поток (example3.cpp, example4.cpp).
3. Создать динамическую переменную в потоке и вернуть адрес при помощи pthread_exit (example2.cpp, example4.cpp).

Необходимо пользоваться защитой при записи в память, выделенную (статически или динамически) не в данном потоке.


## Количество потоков

Информацию о количестве использумых программой потоков можно получить несколькими способами:
1. Посчитать количество директорий в `/proc/PID/task`, где `PID` - id процесса.
2. Извлечь число `NUMBER` из строки вида `Threads:	NUMBER` в файле `/proc/PID/status` (например командой `grep "Threads:" /proc/PID/status | cut -f 2`), где `PID` - id процесса.
3. Посчитать количество `clone(...)` в выводе команды `strace`

В первом и втором случаях число потоков будет также содержать основной поток.